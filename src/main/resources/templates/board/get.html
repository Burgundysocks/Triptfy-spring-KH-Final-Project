<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>get</title>
<style>
    /* #90CAF9, #64B5F6, #42A5F5, #2196F3 */
    * {margin: 0; padding: 0; box-sizing: border-box;}
	
    .wrap {
        width: 1400px;
        margin: 0 auto;
		margin-top: 80px;
    }
	
		
    .main_photo img {
        width: 100%;
        height: 470px;
		object-fit: contain;
	
    }
	
    .info {
        display: flex;
        flex-wrap: nowrap;
        justify-content: space-between;
        margin-top: 30px;
        margin-bottom: 50px;
    }
	
    .info > div:nth-child(2) {
        border-left: 1px solid #f0f0f0;
    }
	
    .info > div:first-child {
        width: 970px;
    }
	
    .info > div:last-child {
        width: 370px;
    }
	
	.title_info {
	    display: inline;
	}
	
	.changebtn {
	    display: inline;
	    float: right;
	}
	
	.changebtn button {
		width: 50px; height: 33px;
		border-radius: 8px;
		border: none;
		background-color: #64B5F6;
		color: #fff;
		font-size: 14px;
	}
	
	.changebtn button:first-of-type {
		margin-right: 3px;
	}
	
	.cnt_info {
	    margin-top: 10px;
	    position: relative;
	}
	
	.cnt_info span {
	    font-size: 13px;
	    margin-right: 10px;
	    color: #9a9a9a;
	}
	
	.cnt_info span:nth-child(1)::after, .cnt_info span:nth-child(2)::after {
	    content: "";
	    position: absolute;
	    top: 50%;
	    width: 2px;
	    height: 2px;
	    background-color: #9a9a9a;
	    display: inline-block;
	    border-radius: 50%;
	    transform: translateX(300%);
	}
	
	.trip_schedule {
	    margin-top: 40px;
	}  
	
	.schedule_detail {
	    margin-top: 10px;
	    background-color: #90caf99a;
	    width: 100%;
	    height: 70px;
	    border-radius: 8px;
	    padding: 11px;
	    padding-left: 38px;
	}
	
	.schedule_detail > p {
	    position: relative;
	    font-weight: bold;
	    color: #333;
	}
	
	.schedule_detail > p:first-child {
	    margin-bottom: 6px;
	}
	
	.schedule_detail > p.trip_day::before {
	    position: absolute;
	    top: 2px;
	    content: "";
	    display: inline-block;
	    background: url("/images/boardimg/schedule.png") no-repeat center/contain;
	    width: 16px;
	    height: 16px;
	    transform: translateX(-150%);
	}
	
	.schedule_detail > p.trip_location::before {
	    position: absolute;
	    top: 3px;
	    content: "";
	    display: inline-block;
	    background: url("/images/boardimg/location.png") no-repeat center/contain;
	    width: 16px;
	    height: 16px;
	    transform: translateX(-150%);
	}
	
	.trip_introduction, .file {
	    margin-top: 60px;
	}

	.file {
		margin-top: 100px;
	}
		
	.trip_introduction > div {
	    margin-top: 13px;
	    color: #333;
	    font-size: 14px;
	width: 100%;
	}

	.file table {
		border: 1px solid #42A5F5;
		border-collapse: collapse;
	}

	.file table th {
		border: 1px solid #cecece;
		width: 150px;
		padding: 10px;
		font-size: 14px;
	}
	
	.file table td {
		border: 1px solid #cecece;
		width: 820px;
		padding: 10px;
		font-size: 14px;
	}
	
	.addfile a {
		display: block;
		margin-bottom: 5px;
	}
	
	.addfile a > .downloadImg {
		width: 15px; height: 15px;
		margin-right: 4px;
	}
	
	.line {
		margin-top: 45px;
		border-bottom: 1px solid #f0f0f0;
	}
	
	.reply_area {
		margin-top: 30px;
	}
	
	.reply_area > div {
	    margin-top: 8px;
	    position: relative;
		border:1px solid #2196F3;
		border-radius: 10px;
	}
	.reply_area > div > div{
		margin-left: 10px;
		margin-bottom: 10px;
	}
	
	.reply_area > div > textarea {
	    overflow: auto;
	    resize: none;
	    width: 91.3%;
	    outline: none;
	    border: 1px solid #2196F3;
	    border-radius: 10px;
	    padding: 11px;
	    font-size: 13px;
	    height: 80px;
	    caret-color: #2196F3;
		border: none;
	}
	
	.reply_area > div > textarea::placeholder {
	    font-size: 13px;
	    color: #aaaaaa;
	}
	
	.reply_area > div > [type="button"] {
	 	position: absolute;
	     top: 55%; right: 1.3%;
	     font-size: 14px;
	     border: none;
	     border-radius: 6px;
	     background-color: #2196F3;
	     width: 60px;
	     height: 35px;
	     color: #fff;
	 }
	
	 .guide_profile {
	     margin-top: 10px;
	     border-radius: 10px;
	     padding: 8px;
	     position: relative;
	     background-color: #f5f5f5;
	     /*padding-bottom: 15px;*/
	 }
	
	 .guide_profile img {
	     width: 35px;
	     height: 35px;
	     margin-right: 9px;
		margin-top: 7px;
		
	 }
	
	 .guide_profile span {
	     position: absolute;
	     top: 16px;
	     font-size: 18px;
	 }
	 
	 
	 .guide_profile img.guidebadge {
		position: absolute;
		top: -3px;
	 	width: 20px; height: 20px;
	 	margin-left: 5px;
	 }
	 
	/*
	 .guide_profile p {
	     margin-top: 5px;
	     font-size: 13px;
	 }
	*/
	 .location {
	     margin-top: 60px;
	 }
	
	.location_detail {
	    margin-top: 10px;
	    border-radius: 10px;
	    border: 1px solid #64B5F6;
	    height: 300px;
	}
	
	.chatting {
	    margin-top: 60px;
	    text-align: center;
	    background-color: #2196F3;
	    padding: 15px;
	    border-radius: 10px;
	    color: #fff;
	    font-weight: bold;
	    font-size: 14px;
    margin-bottom: 30px;
	}
	
	input[type="button"] {
	    cursor: pointer;
	}
	
	#map{
		width:100%;
		height: 100%;
		border-radius: 10px;
	}
	.location p{
		margin-top:5px;
		font-weight: 400;
		color: #9a9a9a;
	}
	
	.info > div {
		position: relative;
	}
	
	#like {
		display: inline-block;
		width: 23px; height: 23px;
	}
	
	.contour {
		display: inline-block;
		border-right: 1px solid #c5c5c5;
		height: 20px;
		width: 1px;
		margin-left: 2px;
	}

	
	#like_area {
		position: relative;
		top: 2px;
		display: inline-block;
		margin-left: 6px;
		width: 23px; height: 23px;
		padding-top: 10px;
		/* border: 1px solid red; */
	}

	/*댓글 디자인*/
	.replies{
		padding:0;
		margin-top:15px;
		border-top: 1px solid gray;
	}
	.reply{
		margin-top: 10px;
		display:flex;
		border-bottom: 1px solid #f2f2f2;
	}
	.reply .reply_userThumnail{
		margin-right:5px;
	}
	.reply .reply_userThumnail img{
		width:50px; height:50px;
	}
	.reply .reply_box .reply_userid{
		width:100%;
		font-size:20px;
		font-weight:bold;
		margin-bottom: 5px;
	}
	.reply .reply_box .reply_content{
		margin-left:5px;
		margin-bottom: 5px;
		max-height:200px;
		overflow-y: auto;
		word-wrap: break-word;
		word-break: break-all;
		white-space: normal;
	}
	.reply .reply_box .reply_sticker img{
		width:100px;
		height:100px;
	}
	.reply .reply_box .reply_regdate{
		font-size:12px;
		color:#979797;
	}
	.reply .reply_tool{
		position: relative;
	}
	.reply .tool-menu {
	    position: absolute;
		width: 100px;
	    top: 30px;
	    right: 0;
	    background-color: white;
	    border: 1px solid #ccc;
	    border-radius: 5px;
	    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
	    padding: 10px;
	    z-index: 10;
	}
	.comment_attach{
		position: relative;
	}
	.reply_area .comment_attach img{
		width:100px; height:100px;
	}
	.reply_area .comment_attach .emoticon-close-btn{
		position: absolute;
		left: 80px;
		top:5px;
	    background: rgba(255, 255, 255, 0.7); 
	    border: none;
	    color: #ff0000;
	    font-size: 16px;
	    font-weight: bold;
	    cursor: pointer;
	    border-radius: 50%;
	    width: 20px;
	    height: 20px;
	    display: flex;
	    align-items: center;
	    justify-content: center;
	    padding: 0;
	}
	.reply_area .comment_attach .emoticon-close-btn:hover{
		background: rgba(255, 255, 255, 1);
	}
	.reply .tool-menu button {
	    display: block;
	    width: 100%;
	    background: none;
	    border: none;
	    padding: 10px 15px;
	    text-align: left;
	    color: #333;
	    cursor: pointer;
	    font-size: 14px;
	}

	.reply .tool-menu button:hover {
	    background-color: #f0f0f0;
	}

	.reply .tool-menu button:focus {
	    outline: none;
	}
	.emoji-picker {
        position: absolute;
        border: 1px solid #ccc;
        background: #fff;
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        padding: 10px;
        margin-top: 5px;
        z-index: 100;
    }
    .emoji-picker span {
        cursor: pointer;
        font-size: 20px;
        margin: 5px;
    }
	.emoji-picker span img{
		width:100px; height:100px;
	}
	.reply .reply_tool svg{
		cursor:pointer;
	}
	.replies-page{
		margin-top: 30px;
		display: flex;
		justify-content: center;
		align-items: center;
	}
	.replies-page *{
		text-align: center;
		margin:0 2px;
	}
	.replies-page .page-btn{
	    padding: 5px;
	    width: 30px; height: 30px;
	    display: inline-block;
	    border-radius: 3px;
	    background-color: rgb(0,200,80);
	    color: #fff;
	    font-weight: bold;
	}
	.replies-page .page-btn:hover{
		background-color: rgb(198, 175, 245);
	}
	
	.nowPage {
		padding: 5px;
		width: 30px;
		height: 30px;
		display: inline-block;
		border-radius: 3px;
		background-color: rgb(198, 175, 245);
		color: #fff;
		font-weight: bold;
	}
	
	.no-reply{
		text-align:center;
		margin-top: 30px;
		margin-bottom: 30px;
	}

</style>
</head>
<body>
	<th:block th:include="~{layout/header::header(${session.loginUser})}"></th:block>
    <div class="wrap">
		
        <div class="main_photo">
            <img th:src="'/BoardThumnail/' + ${thumbnailImg.sysname}" alt="">
        </div>

        <div class="info">
            <div class="">
                <h2 class="title_info">
                    [[${board.title}]]
                </h2>
				
				<div class="contour"></div>
	
				<div id="like_area">
					<img th:if="${boardLike}" src="/images/boardimg/fullheart.png" id="like">
					<img th:unless="${boardLike}" src="/images/boardimg/emptyheart.png" id="like">
				</div>
			 
				<div th:if="${board.userid eq session.loginUser}" class="changebtn">
				    <button th:onclick="modifyBoard([[${board.boardnum}]]);">수정</button>
				    <button th:onclick="deleteBoard([[${board.boardnum}]]);">삭제</button>
				</div>

                <div class="cnt_info">
                    <span>조회수 [[${board.viewcnt}]]</span>
					<span id="likecnt">좋아요 [[${board.likecnt}]]</span>
                    <span>댓글 [[${replyCnt}]]</span>
                </div>

                <div class="trip_schedule">
					
                    <h4 th:if="${boardaddr}">여행 일정</h4>
                    <div class="schedule_detail">
                        <p th:if="${boardaddr}" class="trip_day">[[${boardaddr.startdate}]] - [[${boardaddr.enddate}]]([[${days}]]일)</p>
                        <p th:text="${board.countrycode} == 'kr' ? '대한민국, ' + ${board.regionname} : ${board.regionname}" class="trip_location"></p>
                    </div>

					<div class="trip_introduction">
					    <h4>내용</h4>
					    <div></div>
					</div>
					
					<div class="file addfile" th:if="${files != null and files.size() > 0}">
					    <table>
							<tr>
								<th><h4>첨부 파일</h4></th>
								<td>
									<a th:if="${not file.sysname.contains('BoardThumnail')}" th:href="@{/board/download (sysname=${file.sysname}, orgname=${file.orgname})}" th:each="file:${files}"><img src="/images/boardimg/download.png" class="downloadImg">[[${file.orgname}]]</a>
								</td>
							</tr>
						</table>
					</div>
					
					<div class="line"></div>

                    <div class="reply_area">
                        <h4>댓글</h4>
                        <div>
                            <textarea name="replycontent" class="replycontent" placeholder="댓글을 입력해주세요."></textarea>
							<div class="comment_attach">
								<svg id ="emoji_toggle" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-emoji-smile-fill" viewBox="0 0 16 16" style="cursor:pointer;">
								  <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5M4.285 9.567a.5.5 0 0 1 .683.183A3.5 3.5 0 0 0 8 11.5a3.5 3.5 0 0 0 3.032-1.75.5.5 0 1 1 .866.5A4.5 4.5 0 0 1 8 12.5a4.5 4.5 0 0 1-3.898-2.25.5.5 0 0 1 .183-.683M10 8c-.552 0-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5S10.552 8 10 8"/>
								</svg>
							</div>
                            <input type="button" value="등록" onclick="replySubmit();">
                        </div>
                    </div>
					<div class="replies">
						<!--<div class="reply">				
							<div class="reply_userThumnail"><img src="/images/layoutimg/logo_long.png" alt></div>
							<div class="reply_box">
								<div class="reply_userid">123</div>
								<div class="reply_content">12412442112412414241241242141224141241242124424122141214214124</div>
								<div class="reply_regdate">2024.06.02 15:24</div>
							</div>
							<div class="reply_tool">
								<svg class="tool_btn" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<circle cx="12" cy="5" r="2.25" transform="rotate(90 12 5)" stroke="#1F2023" stroke-width="1.5" stroke-linecap="round"/>
									<circle cx="12" cy="12" r="2.25" transform="rotate(90 12 12)" stroke="#1F2023" stroke-width="1.5" stroke-linecap="round"/>
									<circle cx="12" cy="19" r="2.25" transform="rotate(90 12 19)" stroke="#1F2023" stroke-width="1.5" stroke-linecap="round"/>
								</svg>
							</div>
						</div>
						<div class="reply">				
							<div class="reply_userThumnail"><img src="/images/layoutimg/logo_long.png" alt></div>
							<div class="reply_box">
								<div class="reply_userid">123</div>
								<div class="reply_content">1241244211241241424124124214122414124124212442412214121asdfasfdfdsaasdfsfadsfasfdsaasdffsadsadfsfadsfadsdafsadfasfdadfsadfsdasafdsafd4214124</div>
								<div class="reply_sticker"><img src="/images/layoutimg/logo_long.png" alt></div>
								<div class="reply_regdate">2024.06.02 15:24</div>
							</div>
							<div class="reply_tool">
								<svg class="tool_btn" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<circle cx="12" cy="5" r="2.25" transform="rotate(90 12 5)" stroke="#1F2023" stroke-width="1.5" stroke-linecap="round"/>
									<circle cx="12" cy="12" r="2.25" transform="rotate(90 12 12)" stroke="#1F2023" stroke-width="1.5" stroke-linecap="round"/>
									<circle cx="12" cy="19" r="2.25" transform="rotate(90 12 19)" stroke="#1F2023" stroke-width="1.5" stroke-linecap="round"/>
								</svg>
							</div>
						</div>
						<div class="reply">				
							<div class="reply_userThumnail"><img src="/images/layoutimg/logo_long.png" alt></div>
							<div class="reply_box">
								<div class="reply_userid">123</div>
								<div class="reply_content">12412442112412414241241242141224141241242124424122141214214124</div>
								<div class="reply_regdate">2024.06.02 15:24</div>
							</div>
						</div>-->
					</div>
					<div class="replies-page"></div>
                </div>
            </div>

            <!-- 구분선 -->
            <div></div>

            <div class="">
                <div class="guide_info">
                    <h4>작성자</h4>
                    <div class="guide_profile">
                        <img th:src="'/BoardThumnail/' + ${userprofile.sysname}" alt="">
						<span>[[${board.userid}]]<img th:if="${guide}" src="/images/userimg/guidebadge.png" alt="" class="guidebadge"></span>
						<!--<p>자기 소개를 아직 작성하지 않았습니다</p>-->
                    </div>

                    <div class="location">
                        <h3>장소</h3>
						<p th:if="${boardaddr}">[[${boardaddr.placename}]]</p>
                        <div class="location_detail">
							<div id="map"></div>
                        </div>
                    </div>

                    <div class="chatting">채팅하기</div>
                </div>
            </div>
        </div>
    </div>
</body>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAClH3Zck8wh1CdEBWohj2_PxG1HZsSmEg&libraries=places,geometry"></script>
<script th:inline="javascript">
const map = $("#map");
const defaultLocationName = /*[[${boardaddr != null && boardaddr.placename != null ? boardaddr.placename : board.regionname}]]*/'';
const zoomScope = /*[[${boardaddr != null && boardaddr.placename != null ? 11 : 5}]]*/'';
const content = /*[[${board.content}]]*/'';
let loginUser = /*[[${session.loginUser}]]*/'';
let boardnum = [[${board.boardnum}]];
const geocoder = new google.maps.Geocoder();
let stickerNum = 0;
const replies = $('.replies');
const repliesPage = $('.replies-page');
let emojiContent = `
	           <svg id="emoji_toggle" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-emoji-smile-fill" viewBox="0 0 16 16" style="cursor:pointer;">
	               <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5M4.285 9.567a.5.5 0 0 1 .683.183A3.5 3.5 0 0 0 8 11.5a3.5 3.5 0 0 0 3.032-1.75.5.5 0 1 1 .866.5A4.5 4.5 0 0 1 8 12.5a4.5 4.5 0 0 1-3.898-2.25.5.5 0 0 1 .183-.683M10 8c-.552 0-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5S10.552 8 10 8"/>
	           </svg>
	       `;
let thispage = 1;
	$(document).ready(function() {
	   $(".trip_introduction div").html(content);
	   showReplyList(thispage);
       geocoder.geocode({ 'address': defaultLocationName }, function(results, status) {
           if (status === 'OK') {
               const mapOptions = {
                   zoom: zoomScope,
                   center: results[0].geometry.location,
                   mapTypeId: google.maps.MapTypeId.ROADMAP,
				   disableDefaultUI: true
               };
               
               const map = new google.maps.Map(document.getElementById('map'), mapOptions);
               const marker = new google.maps.Marker({
                   position: results[0].geometry.location,
                   map: map
               });				   
           } else {
               alert('Geocode was not successful for the following reason: ' + status);
           }
   		});
		
		$(document).on('click', '.tool_btn', function(event) {
	       event.stopPropagation();
	       $('.tool-menu').remove();
	       
	       const toolMenu = $('<div class="tool-menu"></div>').html(`
	           <button class="edit-button">수정</button>
	           <button class="delete-button">삭제</button>
	       `);
	    
	       $(this).parent().append(toolMenu);
	   });
	   
	   $(document).on('click', function(event) {
           if (!$(event.target).closest('.reply_tool').length) {
               $('.tool-menu').remove();
           }
       });
	   
	   $(document).on('click', '#emoji_toggle', function() {
	       var $emojiPicker = $('#emoji-picker');
	       if ($emojiPicker.length) {
	           $emojiPicker.remove();
	       } else {
	           const emojiPickerHtml = `
	               <div class="emoji-picker" id="emoji-picker">
	                   <span class="emoticon" id="et1"><img src="/images/emoticon/1.jpg" alt></span>
	                   <span class="emoticon" id="et2"><img src="/images/emoticon/2.jpg" alt></span>
	               </div>
	           `;
	           $('.comment_attach').append(emojiPickerHtml);
	       }
	   });

	   $(document).on('click', '.emoji-picker span', function() {
	       let emojiId = $(this).attr("id").substring(2);
		   stickerNum = emojiId;
	       $('.comment_attach').empty();
	       
	       let newContent = `
	           <img src="/images/emoticon/${emojiId}.jpg" alt>
	           <button class="emoticon-close-btn">&times;</button>
	       `;
	       $('.comment_attach').append(newContent);
	       $('#emoji-picker').remove();
	   });

	   $(document).on('click', '.emoticon-close-btn', function(){
	       $('.comment_attach').empty();
		   stickerNum = 0;
	       $('.comment_attach').append(emojiContent);
	   });
		
	   $(document).on('click', '.delete-button', function(){
			const replyId = $(this).closest('.reply').attr('id').substring(3);
			console.log("리플라이 아이디 : "+replyId)
			boardReplyService.delete(
	            {"replynum": replyId},
	            function(result) {
	                showReplyList(thispage);
	            }
	        );
	   })
	   
	   $(document).on('click', '.edit-button', function(){
			const replyBox = $(this).closest('.reply');
   			const replyId = replyBox.attr('id').substring(3);
			const thisUserId = replyBox.find('.reply_userid').text();
			const thisContent = replyBox.find('.reply_content').text();
			const hasSticker = replyBox.find('.reply_sticker').length > 0;
   			console.log("리플라이 아이디 : "+replyId)
   			boardReplyService.modify(
   	            {"replynum": replyId},
   	            function(result) {
   	                showReplyList(thispage);
   	            }
   	        );
   	   })
   });
	
	// 댓글
	function replySubmit() {
	    const replycontent = $(".replycontent");
	   	const content = replycontent.val();
		console.log(boardnum+loginUser+stickerNum+content+"asdasdasd")
	    
	    if(replycontent.val() == "" && stickerNum == 0) {
	        alert("댓글을 입력해주세요.");
	        replycontent.focus();
	    } else {
	        boardReplyService.insert(
	            {"boardnum": boardnum, "userid": loginUser, "emSysname": stickerNum, "contents": content},
	            function(result) {
	                showReplyList(thispage);
	            }
	        );
			stickerNum = 0;
			replycontent.val("");
			$('.comment_attach').empty();
			$('.comment_attach').append(emojiContent);
	    }
		       
	}
	
	function showReplyList(pagenum){
		boardReplyService.getList(
			{"boardnum":boardnum, "pagenum":pagenum||1},
			function(replyCnt, list){
				//LIST DOM
				let str = "";
				if(list == null || list.length == 0){
					str += `<div class="no-reply">등록된 댓글이 없습니다.</div>`;
					replies.html(str);
					return;
				}
				
				for(let i=0;i<list.length;i++){
					const reply = list[i];
					str += `<div class="reply" id="brn${reply.replynum}">
					<div class="reply_userThumnail"><img src="/images/layoutimg/logo_long.png" alt></div>
			        <div class="reply_box">
			            <div class="reply_userid">${reply.userid}</div>
			            <div class="reply_content">${reply.contents}</div>
					`;
					if(reply.emSysname !== "0"){
						str += `<div class="reply_sticker"><img src="/images/emoticon/${reply.emSysname}.jpg" alt></div>`;
					}
					if(reply.updatecheck == 0){
						str += `<div class="reply_regdate">${formatDateTime(reply.regdate)}</div>`;						
					}else{
						str += `<div class="reply_regdate">${formatDateTime(reply.regdate)}(수정됨)</div>`;	
					}
					str += "</div>"
					if(reply.userid == loginUser){
						str += `						
						<div class="reply_tool">
				            <svg class="tool_btn" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
				                <circle cx="12" cy="5" r="2.25" transform="rotate(90 12 5)" stroke="#1F2023" stroke-width="1.5" stroke-linecap="round"/>
				                <circle cx="12" cy="12" r="2.25" transform="rotate(90 12 12)" stroke="#1F2023" stroke-width="1.5" stroke-linecap="round"/>
				                <circle cx="12" cy="19" r="2.25" transform="rotate(90 12 19)" stroke="#1F2023" stroke-width="1.5" stroke-linecap="round"/>
				            </svg>
				        </div>`;
					}
					str += "</div>"
				}
				replies.html(str);
				
				showReplyPages(replyCnt, pagenum);
			}
		)
	}
	
	function showReplyPages(replyCnt, pagenum){
		let endPage = Math.ceil(pagenum/5)*10;
		let startPage = endPage - 9;
		endPage = (endPage-1)*10 >= replyCnt ? Math.ceil(replyCnt/10) : endPage;
		
		let prev = startPage != 1;
		let next = endPage*5 < replyCnt
		
		let str = "";
		if(prev){
			str += `<a class="changePage page-btn" href="${startPage-10}">&lt;<a>`
		}
		for(let i=startPage;i<=endPage;i++){
			if(i == pagenum){
				str += `<span class="nowPage">${i}</span>` 
			}
			else{
				str += `<a class="changePage page-btn" href="${i}">${i}</a>`
			}
		}
		if(next){
			str += `<a class="changePage page-btn" href="${endPage+10}">&gt;</a>`
		}
		
		repliesPage.html(str);
		
		$(".changePage").on("click",function(e){
			e.preventDefault();
			let target = $(this).attr("href");
			target = parseInt(target);
			thispage = target;
			showReplyList(target);
			window.setTimeout(function(){
				window.scrollTo(0,document.body.scrollHeight);
			},10)
		})
	}
	
	function deleteBoard(boardnum) {
		location.replace("/board/remove?boardnum=" + boardnum);
	}
	
	function modifyBoard(boardnum) {	
		location.replace("/board/modify?boardnum=" + boardnum);
	}
	
	$("#like_area").on("click", function() {
		let loginUser = /*[[${session.loginUser}]]*/"";
		let userid = /*[[${board.userid}]]*/"";	
		let boardnum = /*[[${board.boardnum}]]*/"";
		
		console.log("boardnum: " + boardnum)	
		
		if(loginUser == null) {
			alert("로그인 후 이용 가능합니다.");
			return;
		}
		
		if(loginUser == userid) {
			alert("본인 게시글에는 좋아요를 클릭할 수 없습니다.");
			return;
		}
		
		else {			
			$.ajax({
				url: "/board/like?boardnum=" + boardnum,
				method: "PUT",
				
				success:function(data) {
					console.log(data)
					console.log(data.boardlike)
					console.log(data.board.likecnt)
					
					if(data.boardlike == null || !data.boardlike) {  // 좋아요 등록함
						$("#like_area").html('<img src="/images/boardimg/emptyheart.png" id="like">');
						$("#likecnt").html('좋아요 ' + data.board.likecnt);
					}
					
					else {  // 좋아요 취소함
						$("#like_area").html('<img src="/images/boardimg/fullheart.png" id="like">');
						$("#likecnt").html('좋아요 ' + data.board.likecnt);
					}
						
				},
				
				error:function(data) {
					alert("잠시 후에 다시 시도해주세요.");
				}
				
			});
		}
		
		
		
	})

	const boardReplyService = {
		insert:function(data,callback){
			$.ajax({
				type:"POST",
				url:"/board/replyRegist",
				data:JSON.stringify(data),
				contentType:"application/json;charset=utf-8",
				success:function(result,status,xhr){
					callback(result)
				},
				error:function(result,status,xhr){
					
				}
			})
		},
		getList:function(data,callback){
			$.ajax({
				type:"GET",
				url:"/board/replyList",
				data:data,
				contentType:"application/json;charset=utf-8",
				success:function(result,status,xhr){
					callback(result.replyCnt,result.list);
				},
				error:function(result,status,xhr){
					
				}
			})
		},
		modify:function(data,callback){
			$.ajax({
				type:"POST",
				url:"/board/replyModify",
				data:data,
				contentType:"application/json;charset=utf-8",
				success:function(status,xhr){
					callback(result);
				},
				error:function(status,xhr){
					
				}
			})
		},
		delete:function(data, callback){
			$.ajax({
				type:"POST",
				url:"/board/replyDelete",
				data:JSON.stringify(data),
				contentType:"application/json;charset=utf-8",
				success:function(result){
					callback(result)
				},
				error:function(status,xhr){
					 console.error("AJAX Error:", xhr.status, status);
				}
			})
		}
	}
	
	function formatDateTime(dateTimeStr) {
	    const dateTime = new Date(dateTimeStr);

	    const year = dateTime.getFullYear();
	    const month = String(dateTime.getMonth() + 1).padStart(2, '0');
	    const day = String(dateTime.getDate()).padStart(2, '0');
	    const hours = String(dateTime.getHours()).padStart(2, '0');
	    const minutes = String(dateTime.getMinutes()).padStart(2, '0');

	    const formattedDate = `${year}.${month}.${day}  ${hours}:${minutes}`;
	    return formattedDate;
	}

</script>
</html>